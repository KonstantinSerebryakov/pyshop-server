import{k as f,u as E,U as S}from"./index.eef3f5a4.js";import{EVENT_AUTH as a}from"./event-bus.14489dbb.js";import{u as l}from"./user-info-store.4a21e835.js";import"./axios.0ddf9e5a.js";import{A as p}from"./AuthApi.d51238fa.js";import"./mitt.550594b0.js";import"./index.565fc185.js";import"./ApiService.6561fc5e.js";import"./ApiConstants.1f91d7b3.js";var $=f(({app:i,store:n,router:u})=>{const s=i.config.globalProperties.$eventBus,e=E(n),c=l(n);s.on(a.LOGIN_SUCCESS,o=>{const r=Math.floor(Date.now()/1e3),t=o;e.$state.data=new S(t.user),e.$state.refreshToken={...t.refresh_token,iat:r},e.$state.accessToken={...t.access_token,iat:r}}),s.on(a.LOGOUT_SUCCESS,()=>{var o;p.logout((o=e.refreshToken)==null?void 0:o.token),e.clear(),c.clear(),sessionStorage.clear()}),s.on(a.REFRESH_TOKEN_UNVALIDATED,()=>{e.clear(),c.clear(),e.clearRefreshToken(),sessionStorage.clear()}),s.on(a.REFRESH_TOKEN_REFRESHED,o=>{const r=Math.floor(Date.now()/1e3),t=o;e.$state.refreshToken={...t.refresh_token,iat:r},e.$state.accessToken={...t.access_token,iat:r}})});export{$ as default};
