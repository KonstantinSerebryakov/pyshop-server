import{l as b,j as q,k as _,n as C,m as I,t as Q}from"./throttle.ca1ee90c.js";import{d as S,r as u,a as N,z as k,E as A,C as o,B as g,j as s,Q as h,H as B,a0 as P,N as E}from"./index.791b8fcf.js";import{_ as R,a as V,A as D}from"./AuthApi.88e3e368.js";import"./use-dark.54a7f098.js";import"./index.1b589c80.js";import"./axios.e3f3e6f9.js";import"./ApiConstants.a713ec12.js";import"./event-bus.244f33bd.js";import"./mitt.550594b0.js";import"./ApiService.4b53f972.js";const $={class:"col-12 row full-height content-around"},j=g("div",{class:"text-h6 text-center"},"Login",-1),W=S({__name:"SignInPage",setup(z){const i=u(null),r=u(null),c=u(null),d=u(null);function w(){var t,l,e,n;let a=!0;return a=((l=(t=i.value)==null?void 0:t.validate())!=null?l:!1)&&a,a=((n=(e=r.value)==null?void 0:e.validate())!=null?n:!1)&&a,a}function x(){var a,t,l,e;return{email:(t=(a=i.value)==null?void 0:a.value)!=null?t:"",password:(e=(l=r.value)==null?void 0:l.value)!=null?e:""}}const y=Q(async a=>{if(a.preventDefault(),!w())return;m(),d.value=E.create({type:"info",spinner:!0,message:"Authorizing...",position:"top",timeout:0});const t=x(),l=await D.login(t);c.value=l.abort,l.apiPromise.then(e=>{var p,v;const n=d.value;if(n&&n(),!e)return;const f=e.status;(f===404||f===401)&&((p=i.value)==null||p.showEmailInvalidError(),(v=r.value)==null||v.showInvalidPasswordError())}).catch(e=>{console.log(e)})},500);function m(){const a=d.value;a&&a();const t=c.value;t!==null&&(t(),c.value=null)}return N(()=>{m()}),(a,t)=>(k(),A(b,{class:"window-height"},{default:o(()=>[g("div",$,[s(I,{class:"col-12",onSubmit:P(y)},{default:o(()=>[s(q,{class:"auth-card col-12"},{default:o(()=>[s(_,{class:"q-px-md col-12"},{default:o(()=>[j,s(R,{ref_key:"emailInputRef",ref:i,class:"q-mt-lg"},null,512),s(V,{ref_key:"passwordInputRef",ref:r,class:"q-mt-lg"},null,512)]),_:1}),s(C,{align:"right",class:"q-px-md q-mb-md col-12"},{default:o(()=>[s(h,{type:"submit",label:"Login",color:"primary"})]),_:1}),s(_,{class:"q-px-md col-12 text-h7 text-center"},{default:o(()=>[B(" Don't have an account? "),s(h,{to:{path:"/signup",query:a.$route.query},label:"Sign Up",flat:"",unelevated:"",rounded:"",dense:"",color:"purple"},null,8,["to"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])]),_:1}))}});export{W as default};
