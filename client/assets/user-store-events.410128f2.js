import{k as S,u as i,U as f}from"./index.ab238b2a.js";import{EVENT_AUTH as s}from"./event-bus.e5e4b753.js";import{u as l}from"./user-info-store.dbe7e8b3.js";import"./mitt.550594b0.js";import"./index.e92490f7.js";import"./axios.49e4da64.js";import"./ApiService.9ed08d4e.js";import"./axios.c3389449.js";var d=S(({app:E,store:n,router:p})=>{const r=E.config.globalProperties.$eventBus,e=i(n),c=l(n);r.on(s.LOGIN_SUCCESS,a=>{const t=Math.floor(Date.now()/1e3),o=a;e.$state.data=new f(o.user),e.$state.refreshToken={...o.refresh_token,iat:t},e.$state.accessToken={...o.access_token,iat:t}}),r.on(s.LOGOUT_SUCCESS,()=>{e.clear(),c.clear(),sessionStorage.clear()}),r.on(s.REFRESH_TOKEN_UNVALIDATED,()=>{e.clear(),c.clear(),e.clearRefreshToken(),sessionStorage.clear()}),r.on(s.REFRESH_TOKEN_REFRESHED,a=>{const t=Math.floor(Date.now()/1e3),o=a;e.$state.refreshToken={...o.refresh_token,iat:t},e.$state.accessToken={...o.access_token,iat:t}})});export{d as default};
