import{l as b,j as q,k as _,n as C,m as I,t as Q}from"./throttle.591987d3.js";import{d as S,r as u,a as N,z as k,E as A,C as l,B as g,j as s,Q as h,H as B,a0 as P,N as E}from"./index.300c9223.js";import{_ as R,a as V,A as D}from"./AuthApi.ebcd8c17.js";import"./use-dark.cd509db7.js";import"./index.e92490f7.js";import"./axios.49e4da64.js";import"./ApiConstants.4dae4bb1.js";import"./event-bus.c1fbaac4.js";import"./mitt.550594b0.js";import"./ApiService.a9cc5efe.js";import"./axios.2f74100b.js";const $={class:"col-12 row full-height content-around"},j=g("div",{class:"text-h6 text-center"},"Login",-1),X=S({__name:"SignInPage",setup(z){const i=u(null),r=u(null),c=u(null),d=u(null);function w(){var a,o,e,n;let t=!0;return t=((o=(a=i.value)==null?void 0:a.validate())!=null?o:!1)&&t,t=((n=(e=r.value)==null?void 0:e.validate())!=null?n:!1)&&t,t}function x(){var t,a,o,e;return{email:(a=(t=i.value)==null?void 0:t.value)!=null?a:"",password:(e=(o=r.value)==null?void 0:o.value)!=null?e:""}}const y=Q(async t=>{if(t.preventDefault(),!w())return;m(),d.value=E.create({type:"info",spinner:!0,message:"Authorizing...",position:"top",timeout:0});const a=x(),o=await D.login(a);c.value=o.abort,o.apiPromise.then(e=>{var p,v;const n=d.value;if(n&&n(),!e)return;const f=e.status;(f===404||f===401)&&((p=i.value)==null||p.showEmailInvalidError(),(v=r.value)==null||v.showInvalidPasswordError())}).catch(e=>{console.log(e)})},500);function m(){const t=d.value;t&&t();const a=c.value;a!==null&&(a(),c.value=null)}return N(()=>{m()}),(t,a)=>(k(),A(b,{class:"window-height"},{default:l(()=>[g("div",$,[s(I,{class:"col-12",onSubmit:P(y)},{default:l(()=>[s(q,{class:"auth-card col-12"},{default:l(()=>[s(_,{class:"q-px-md col-12"},{default:l(()=>[j,s(R,{ref_key:"emailInputRef",ref:i,class:"q-mt-lg"},null,512),s(V,{ref_key:"passwordInputRef",ref:r,class:"q-mt-lg"},null,512)]),_:1}),s(C,{align:"right",class:"q-px-md q-mb-md col-12"},{default:l(()=>[s(h,{type:"submit",label:"Login",color:"primary"})]),_:1}),s(_,{class:"q-px-md col-12 text-h7 text-center"},{default:l(()=>[B(" Don't have an account? "),s(h,{to:{path:"/signup",query:t.$route.query},label:"Sign Up",flat:"",unelevated:"",rounded:"",dense:"",color:"purple"},null,8,["to"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])]),_:1}))}});export{X as default};
